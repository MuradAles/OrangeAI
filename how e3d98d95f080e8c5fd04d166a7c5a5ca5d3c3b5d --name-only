[33mda8535b[m[33m ([m[1;36mHEAD[m[33m -> [m[1;32mfeatures[m[33m)[m Main Achievement: Implemented viewport-based lazy translation with smart language detection and RAG pipeline for embeddings. Messages now translate only as they scroll into view, preventing same-language translations and enabling semantic search across chats. Key Features: Added cultural context highlighting with mood-aware detection, group chat language support with dynamic detection, and RAG-powered chat summarization using OpenAI embeddings. Translation UI overhauled with new menu structure and progressive display for better UX. üìÅ Files Modified: Frontend Files: src/features/chat/components/ChatModal.tsx - Added viewport-based lazy translation with FlashList onViewableItemsChanged and smart language filtering src/features/chat/components/MessageBubble.tsx - Integrated cultural highlighting with useCulturalAnalysis hook and cultural phrase detection src/features/chat/components/QuickActionsPopover.tsx - Added Copy and Delete for Everyone buttons with updated UI layout src/features/chat/components/AICommandsMenu.tsx - Simplified to only show Summary action, removed auto-translate toggle src/features/chat/components/MessageInput.tsx - Simplified language detection to read directly from chat document for faster loading src/services/firebase/CulturalService.ts - New service for cultural context analysis and chat summarization via Cloud Functions src/features/chat/hooks/useCulturalAnalysis.ts - New hook for auto-analyzing received messages with 24-hour caching src/shared/types/Chat.ts - Added detectedLanguages array field to Chat interface src/services/firebase/GroupService.ts - Initialize detectedLanguages array when creating groups src/services/firebase/ChatService.ts - Added updateDetectedLanguages method and include in chat data fetching src/store/ChatStore.messages.ts - Updated sendMessage to detect language and update chat's detectedLanguages app/(tabs)/find.tsx - New search across all chats UI with semantic search integration Backend Files: functions/src/services/TranslationService.ts - Added quick language detection to skip same-language translations and reduce costs functions/src/services/ChatContextService.ts - Updated generateUserSummary with RAG integration and semantic search queries functions/src/services/CulturalAnalysisService.ts - Made slang detection more generous with mood-aware cultural phrase detection functions/src/services/EmbeddingService.ts - New service for OpenAI embeddings generation and semantic search with cosine similarity functions/src/index.ts - Updated Cloud Functions with searchAllChats, generateMessageEmbedding, and language parameter support
[33m419249e[m auto-translate
[33me3d98d9[m feat: implement viewport-based lazy translation with smart language detection
[33me3513af[m[33m ([m[1;31morigin/features[m[33m)[m We implemented a complete AI-powered translation system with cultural context analysis and chat mood awareness. We also fixed critical UI issues including chat summary scrolling and cultural highlighting using text matching instead of position-based highlighting.
[33m63dd6d4[m Enhanced the AI translation system to store translations locally in SQLite instead of Firestore, ensuring user privacy. Implemented a beautiful bottom sheet UI to replace white alert dialogs, added user language preferences in profile settings, and fixed translation persistence issues on app reload. Translations now display inline in bold text above the original message, and each user maintains their own private translations that never sync to the cloud.
